# AI-Powered Product Recommendation System

## Overview
Mercadona-LLM is an advanced system designed to scrape, process, and store product data from Mercadona's website. By leveraging cutting-edge AI models (LLMs and VLMs), the system enables users to find products based on natural language queries, such as:

- "I want a lactose-free drink, similar to almond milk but cheaper."
- "Something like Nutella but healthier."

The system integrates web scraping, AI-powered data enrichment, and dual-database storage to provide fast and accurate product recommendations.

---

## Key Features

### 1. Web Scraping
- **Purpose**: Extract product data, including:
  - Title
  - Category and Subcategory
  - Description
  - Price
  - Weight and Unit
  - Ingredients
  - Origin
  - Images
- **Tool Used**: Playwright for dynamic content handling.
- **Concurrency Management**: `asyncio.Semaphore` ensures efficient scraping without overwhelming the server.

### 2. AI Integration
- **LLMs (Language Models)**:
  - Normalize and enrich scraped data (e.g., extract brand, allergens, and claims).
  - Generate embeddings for semantic search.
- **VLMs (Vision Language Models)**:
  - Process product images to extract nutritional information and claims.

### 3. Data Storage
The system uses two types of databases:

#### Relational Database (PostgreSQL or SQLite)
- **Purpose**: Store structured product data for fast lookups by filters.
- **Fields Stored**:
  - Product ID
  - Title
  - Category and Subcategory
  - Price
  - Weight and Unit
  - Brand
  - Ingredients
  - Nutritional Information
  - Allergens
  - Claims
  - Origin
  - Store Availability
  - Product Link
  - Image Path

#### Vector Database (Qdrant or Chroma)
- **Purpose**: Enable semantic search by storing embeddings generated by LLMs.
- **Fields Stored**:
  - Title
  - Category
  - Subcategory
  - Description
  - Brand
  - Weight and Unit
  - Relative Price
  - Attributes
  - Allergens
  - Origin
  - Nutritional Information

### 4. Semantic Search
- **Workflow**:
  1. **User Query**: The user provides a natural language description.
  2. **LLM Embedding**: The query is converted into a text embedding.
  3. **Vector Database Search**: The embedding is used to perform a semantic search.
  4. **Relational Database Lookup**: The top-k product IDs from the vector database are used to fetch detailed product information.
  5. **LLM Ranking**: The LLM ranks the products based on user preferences (e.g., price, claims, allergens) and presents the results.

---

## Example JSON Structure
The system extracts and processes product data into the following JSON structure:

```json
{
  "brand": "",
  "category": "",
  "ingredients": "",
  "allergens": "",
  "nutritional_info": {
    "kcal": "",
    "fat": "",
    "saturated_fat": "",
    "carbs": "",
    "sugars": "",
    "proteins": "",
    "fibra": "",
    "salt": ""
  },
  "weight": "",
  "claims": []
}
```

---

## Diagrams
The following diagrams illustrate the system's architecture and workflow:

### Storage Systems
1️⃣ **Relational DB (PostgreSQL or SQLite)**:
- Optimized for fast product lookups by filters.
- Stores structured data such as product ID, title, category, price, and more.

2️⃣ **Vector DB (Qdrant or Chroma)**:
- Enables semantic search by storing embeddings for fields like title, description, and nutritional information.

### Semantic Search Workflow
1. **User Prompt** → [LLM] generates text embedding.
2. **Vector DB** → Performs semantic search using the embedding.
3. **Top-k Product IDs** → Query the Relational DB.
4. **Relational DB** → Fetches detailed product information (e.g., price, weight, product link).
5. **LLM** → Ranks candidates based on user preferences and displays results.

---

## Use Cases
- **Product Lookup by Filters**: Quickly find products based on category, price range, or weight.
- **Semantic Search**: Discover products using natural language queries.
- **Nutritional Information Extraction**: Extract and display detailed nutritional data from product images.
- **Allergen Identification**: Highlight allergens based on ingredient analysis.

---

## Future Improvements
- Expand product coverage to include more categories and subcategories.
- Incorporate image embeddings for multimodal search.
- Optimize performance with distributed scraping.
- Enhance allergen detection with custom-trained models.
